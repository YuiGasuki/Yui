<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Yui_图片</title>
<style>
#body {
margin: 10px;
column-count: 2;
column-gap: 10px;

}
#body div {
margin-bottom: 10px;
}
img {
width: 100%;
height:100%;
border-style:solid;
border-width:1px;
border-color:#aaaaaa;
min-height:100vh;
background:#eee;
}
</style>
</head>
<body>
<div id="body">
</div>
<div style="width:100%;background:#eee;height:30px;display:flex;
flex-direction:column;
align-items:center;
justify-content:center;border-radius:6px;
border-style:solid;
border-width:1px;
border-color:#aaaaaa;color:#aaaaaa;" onclick="getimg()" id="getbody">加载更多</div>
<script>
const options = { 
 method: 'GET', 
 header:{ 
 'access_token':'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' 
 } 
 };
 
const IdBody = document.getElementById('body');
let a=0;
let data;
fetch("https://api.github.com/repos/yuiandazucat/Yui/contents/image",options).then(response => response.json()).then(Data =>{
data=Data;
a=data.length-1;



getimg();




});


const getimg = () =>{
a=a-4;
if(a<=3){
document.getElementById('getbody').style.display="none";
}
for(let i = a;i>=(a-3);i=i-1){
IdBody.innerHTML += `
<div>
<img data-src="/Yui/image/`+data[i].name+`" class="titleimg" />
</div>
`;
}

console.log(IdBody.innerHTML);

document.querySelectorAll("img").forEach(item=>{
io.observe(item);
})
}



const io = new IntersectionObserver(function (items){
items.forEach(item=>{
if(item.isIntersecting){
if(item.target.src==""){
item.target.src=item.target.getAttribute('data-src');
item.target.style.minHeight="0px";
item.onerror = () =>{
item.src="none.jpg";
}
}
}
})
});

</script>
</body>
</html>